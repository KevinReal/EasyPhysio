<div class="main-container">
  <div class="row header-container">
    <div class="col-12 calendar-container">
      <p>
        <span (click)="populateWeekDays(-7)">< </span>
        <span>{{weekDays[0]}} - {{weekDays[4]}} {{monthsOfTheYear[recalculatedMonth]}}</span>
        <span (click)="populateWeekDays(7)"> ></span>
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col-1">

      <div class="height-first-row"></div>

      <div *ngFor="let hour of workingHours; let i = index">
        <div class="first-column">
          <p class="transform-first-row-text">{{hour}}</p>
        </div>
      </div>
    </div>

    <div class="col-11">
      <div class="row height-first-row">
        <div class="col" *ngFor="let day of daysOfTheWeek; let i = index">
          <p class="align-center">{{day}}</p>
          <p class="align-center">{{weekDays[i]}}</p>
        </div>
      </div>

      <div cdkDropListGroup class="scheduler-container" *ngIf="appointments">
        <div *ngFor="let row of numberRowsGrid; let i = index"
             class="row">
          <div *ngFor="let col of numberCols; let j = index"
               (click)="openModalCreate(crear, i, j)"
               cdkDropList
               cdkDropListOrientation="horizontal"
               [cdkDropListData]="appointments | appointments: workingHours[i] : weekDays[j]"
               (cdkDropListDropped)="drop($event, workingHours[i], weekDays[j])"
               class="col drop-list-grid">
            <div *ngFor="let cita of appointments | appointments: workingHours[i] : weekDays[j]"
                 (click)="openModal(editarBorrar, cita, i, j)"
                 cdkDragBoundary=".scheduler-container"
                 class="grid-scheduler"
                 cdkDrag>
              <p>{{cita.treatment.patient.name}} {{cita.treatment.patient.lastname}}</p>
              <p>Sala {{cita.roomNumber}}</p>
              <p>{{cita.reasonAppointment}}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>





<ng-template #editarBorrar let-modal>
  <div class="modal-body">
    <form>
      <div class="form-group">
        <label for="paciente">Paciente:</label>
        <div class="input-group">
          <input id="paciente" class="form-control" placeholder="Escriba nombre del paciente" name="paciente" [ngModel]="selectedAppointment.treatment.patient.name">
        </div>
        <label for="sala">Sala:</label>
        <div class="input-group">
          <input id="sala" class="form-control" placeholder="Elija sala" name="sala" [ngModel]="selectedAppointment.roomNumber">
        </div>
        <label for="motivoCita">Motivo de la cita:</label>
        <div class="input-group">
          <input id="motivoCita" class="form-control" placeholder="Escriba motivo de la cita" name="motivoCita" [ngModel]="selectedAppointment.reasonAppointment">
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    </div>
</ng-template>




<ng-template #crear let-modal>
  <div class="modal-body">
    <form>
      <div class="form-group">
        <label for="pacienteNuevo">Paciente:</label>
        <div class="input-group">
          <input id="pacienteNuevo" class="form-control" placeholder="Escriba nombre del paciente" name="paciente" [(ngModel)]="newAppointment.treatment.patient.name">
        </div>
        <label for="salaNueva">Sala:</label>
        <div class="input-group">
          <input id="salaNueva" class="form-control" placeholder="Elija sala" name="sala" [(ngModel)]="newAppointment.roomNumber">
        </div>
        <label for="motivoCitaNuevo">Motivo de la cita:</label>
        <div class="input-group">
          <input id="motivoCitaNuevo" class="form-control" placeholder="Escriba motivo de la cita" name="motivoCita" [(ngModel)]="newAppointment.reasonAppointment">
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-dark" (click)="createAppointment(newAppointment)">Crear</button>
  </div>
</ng-template>
